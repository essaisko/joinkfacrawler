ìë™ë°°í¬í…ŒìŠ¤íŠ¸

# Korean Football Association Crawler

í•œêµ­ì¶•êµ¬í˜‘íšŒ(KFA) ê²½ê¸° ë°ì´í„°ë¥¼ í¬ë¡¤ë§í•˜ê³  Firebaseì— ì—…ë¡œë“œí•˜ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.

## ì£¼ìš” ê¸°ëŠ¥

- ğŸˆ KFA ê²½ê¸° ë°ì´í„° ì‹¤ì‹œê°„ í¬ë¡¤ë§
- ğŸ”¥ Firebase Firestore ìë™ ì—…ë¡œë“œ
- ğŸŒ ì›¹ ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•œ í¬ë¡¤ë§ ì œì–´
- ğŸ“Š ì‹¤ì‹œê°„ ì§„í–‰ ìƒí™© ëª¨ë‹ˆí„°ë§
- ğŸ“‹ **Firebase ì—°ë™ CSV ê´€ë¦¬** - ë¡œì»¬ ì„œë²„ ì—†ì´ë„ ì–¸ì œë‚˜ ì›¹ì—ì„œ ì§ì ‘ í¸ì§‘ ê°€ëŠ¥
- ğŸš€ ì„ íƒì  í¬ë¡¤ë§ ë° ì—…ë¡œë“œ (ë…„ë„, ì›”, ë¦¬ê·¸ë³„ í•„í„°ë§)
- ğŸ›‘ ì‹¤ì‹œê°„ í”„ë¡œì„¸ìŠ¤ ì œì–´ (í¬ë¡¤ë§/ì—…ë¡œë“œ ì¤‘ë‹¨ ê¸°ëŠ¥)
- ğŸ”„ **ë‹¤ì¤‘ í•„í„° í¬ë¡¤ë§** - ì—¬ëŸ¬ ì¡°ê±´ì„ ë™ì‹œì— ì„¤ì •í•˜ì—¬ ìˆœì°¨ ì‹¤í–‰

## ê¸°ìˆ  ìŠ¤íƒ

- **Backend**: Node.js, Express.js
- **Frontend**: HTML, CSS, JavaScript
- **Scraping**: Puppeteer
- **Database**: Firebase Firestore
- **Real-time**: Socket.IO
- **Deployment**: Oracle Cloud Infrastructure (OCI)

## ì„¤ì¹˜ ë° ì‹¤í–‰

### ë¡œì»¬ í™˜ê²½

```bash
# ì €ì¥ì†Œ í´ë¡ 
git clone <repository-url>
cd joinkfacrawler

# ì˜ì¡´ì„± ì„¤ì¹˜ (Chrome ìë™ ì„¤ì¹˜ í¬í•¨)
npm install

# ì„œë²„ ì‹¤í–‰
npm start
```

### Oracle Cloud Infrastructure (OCI) ë°°í¬

1. **ì„œë²„ í™˜ê²½**:
   - **ë„ë©”ì¸**: `ssurpass.com`
   - **ì„œë²„**: Ubuntu 22.04 LTS (Oracle Cloud)
   - **ì›¹ì„œë²„**: nginx (í”„ë¡ì‹œ ì„œë²„)
   - **í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬**: PM2

2. **ë°°í¬ ì„¤ì •**:
   - **ìë™ ë°°í¬**: GitHub Webhookì„ í†µí•œ ìë™ ë°°í¬ ì§€ì›
   - **ë°°í¬ ì—”ë“œí¬ì¸íŠ¸**: `POST /deploy` (í† í° ì¸ì¦)
   - **í¬íŠ¸**: 3000 (ë‚´ë¶€), 80/443 (ì™¸ë¶€)

3. **Chrome ì„¤ì¹˜**: 
   - `npm install` ì‹¤í–‰ ì‹œ postinstall ìŠ¤í¬ë¦½íŠ¸ê°€ ìë™ìœ¼ë¡œ Chromeì„ ì„¤ì¹˜í•©ë‹ˆë‹¤
   - Chrome ê²½ë¡œëŠ” `chrome-config.json`ì— ì €ì¥ë©ë‹ˆë‹¤

4. **í˜„ì¬ ìƒíƒœ**: 
   - âš ï¸ **502 Bad Gateway ì˜¤ë¥˜ í•´ê²° ì¤‘**
   - ì„œë²„ êµ¬ì¶• ì™„ë£Œ, nginx ì„¤ì • ì™„ë£Œ
   - Node.js ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ìƒíƒœ ì ê²€ ì¤‘

## íŒŒì¼ êµ¬ì¡°

```
joinkfacrawler/
â”œâ”€â”€ server.js              # Express ì„œë²„ + Socket.IO + Firebase CSV ì—°ë™
â”œâ”€â”€ meat.js                # ìµœì í™”ëœ í¬ë¡¤ë§ ë¡œì§ (ì†ë„ ê°œì„ )
â”œâ”€â”€ firebase_uploader.js   # Firebase ì—…ë¡œë“œ + CSV ê´€ë¦¬ ë¡œì§
â”œâ”€â”€ index.html            # ì›¹ ì¸í„°í˜ì´ìŠ¤ (ë‹¤ì¤‘ í•„í„° ì§€ì›)
â”œâ”€â”€ leagues.csv           # ë¦¬ê·¸ ì„¤ì • íŒŒì¼ (Firebase ë°±ì—…)
â”œâ”€â”€ firebase-adminsdk.json # Firebase ì„œë¹„ìŠ¤ ê³„ì • í‚¤
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ install-chrome.js  # Chrome ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ render-build.sh       # ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ (Render/Oracle Cloud í˜¸í™˜)
â”œâ”€â”€ debug-server.sh       # ì„œë²„ ë””ë²„ê¹… ìŠ¤í¬ë¦½íŠ¸
â””â”€â”€ results/              # í¬ë¡¤ë§ ê²°ê³¼ ì €ì¥
```

## ì‚¬ìš© ë°©ë²•

### ğŸ”„ ë‹¤ì¤‘ í•„í„° í¬ë¡¤ë§ (NEW!)

ì—¬ëŸ¬ ê°œì˜ í¬ë¡¤ë§ ì¡°ê±´ì„ ë™ì‹œì— ì„¤ì •í•˜ì—¬ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!

1. **ë‹¤ì¤‘ í¬ë¡¤ë§ ì„¤ì •**: 
   - â• í•„í„° ì¶”ê°€ ë²„íŠ¼ìœ¼ë¡œ ì—¬ëŸ¬ ì¡°ê±´ ìƒì„±
   - ê° ì¡°ê±´ë³„ë¡œ ë…„ë„/ì›”/ë¦¬ê·¸ ì„¤ì •
   - í•œ ë²ˆì— ëª¨ë“  ì¡°ê±´ ìˆœì°¨ ì‹¤í–‰

2. **ë‹¤ì¤‘ ì—…ë¡œë“œ ì„¤ì •**:
   - í¬ë¡¤ë§ ì¡°ê±´ê³¼ ë³„ë„ë¡œ ì—…ë¡œë“œ ì¡°ê±´ ì„¤ì •
   - "í¬ë¡¤ë§ í•„í„° ë³µì‚¬" ë²„íŠ¼ìœ¼ë¡œ ì‰½ê²Œ ë³µì‚¬

3. **ì„±ëŠ¥ ìµœì í™”**:
   - ëŒ€ê¸°ì‹œê°„ ìµœì í™” (100-200ms â†’ 50-150ms, ë™ì  ì¡°ì •)
   - í˜ì´ì§€ ë¡œë”© ìµœì í™” (`domcontentloaded` ì‚¬ìš©)
   - ë¶ˆí•„ìš”í•œ ë¦¬ì†ŒìŠ¤ ì°¨ë‹¨ (ì´ë¯¸ì§€, CSS ë“±)
   - ì¬ì‹œë„ ë¡œì§ ì¶”ê°€ (ìµœëŒ€ 3ë²ˆ ì‹œë„)
   - ë™ì  íƒ€ì„ì•„ì›ƒ (15â†’25â†’35ì´ˆ)

### ğŸ”¥ Firebase ì—°ë™ CSV ê´€ë¦¬

`leagues.csv` íŒŒì¼ì´ Firebaseì™€ ì—°ë™ë˜ì–´ **ë¡œì»¬ ì„œë²„ ì‹¤í–‰ ì—†ì´ë„** ì–¸ì œë‚˜ ì›¹ì—ì„œ ì§ì ‘ í¸ì§‘í•˜ê³  ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!

1. **ê¸°ë³¸ ì›¹ ì¸í„°í˜ì´ìŠ¤ ì ‘ì†**: 
   - ë¡œì»¬: `http://localhost:3000`
   - ë°°í¬ëœ ì„œë²„: `http://ssurpass.com` (í˜„ì¬ 502 ì˜¤ë¥˜ í•´ê²° ì¤‘)
   
2. **ë¦¬ê·¸ ì„¤ì • í¸ì§‘**: 
   - ì›¹ í˜ì´ì§€ì˜ CSV ì—ë””í„°ì—ì„œ ì§ì ‘ í¸ì§‘
   - "Firebaseì— ì €ì¥" ë²„íŠ¼ìœ¼ë¡œ ì¦‰ì‹œ ì €ì¥
   - ğŸ”„ ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ìœ¼ë¡œ ìµœì‹  ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
   
3. **Firebase ì—…ë¡œë“œ**: 
   - ì—…ë¡œë“œ í•„í„° ì„¤ì • (ì„ íƒì  ì—…ë¡œë“œ)
   - "Firestoreì— ì—…ë¡œë“œ" ë²„íŠ¼ í´ë¦­
   - "í¬ë¡¤ë§ í•„í„° ë³µì‚¬" ë²„íŠ¼ìœ¼ë¡œ í•„í„° ì¡°ê±´ ì‰½ê²Œ ë³µì‚¬

### ğŸ“Š ì„±ëŠ¥ ê°œì„  ì‚¬í•­

| í•­ëª© | ì´ì „ | í˜„ì¬ | ê°œì„ ìœ¨ |
|------|------|------|--------|
| ìš”ì²­ ëŒ€ê¸°ì‹œê°„ | 100-200ms | 50-150ms (ë™ì  ì¡°ì •) | ìµœëŒ€ 50% ë‹¨ì¶• |
| í˜ì´ì§€ ë¡œë”© | networkidle2 (15ì´ˆ) | domcontentloaded (15ì´ˆ) | ì•ˆì •ì„± í–¥ìƒ |
| ë¦¬ì†ŒìŠ¤ ë¡œë”© | ëª¨ë“  ë¦¬ì†ŒìŠ¤ | í•„ìˆ˜ë§Œ ë¡œë”© | ì´ë¯¸ì§€/CSS ì°¨ë‹¨ |
| í•„í„° ì²˜ë¦¬ | ë‹¨ì¼ ì¡°ê±´ | ë‹¤ì¤‘ ì¡°ê±´ ìˆœì°¨ ì²˜ë¦¬ | ë°°ì¹˜ ì²˜ë¦¬ ì§€ì› |
| ì•ˆì •ì„± | ë‹¨ì¼ ì‹œë„ | ìµœëŒ€ 3ë²ˆ ì‹œë„ | ì¬ì‹œë„ ë¡œì§ ì¶”ê°€ |
| íƒ€ì„ì•„ì›ƒ ì „ëµ | ê³ ì • ì‹œê°„ | ë™ì  ì¦ê°€ (15â†’25â†’35ì´ˆ) | ë„¤íŠ¸ì›Œí¬ ìƒíƒœ ëŒ€ì‘ |

### ì£¼ìš” ê°œì„ ì‚¬í•­

- âœ… **Firebase ìë™ ë™ê¸°í™”**: CSV í¸ì§‘ ì‹œ Firebaseì— ìë™ ì €ì¥
- âœ… **ì›¹ ì „ìš© í¸ì§‘**: ë¡œì»¬ ì„œë²„ ì—†ì´ë„ ì–´ë””ì„œë‚˜ CSV í¸ì§‘ ê°€ëŠ¥
- âœ… **ì‹¤ì‹œê°„ ìƒíƒœ í‘œì‹œ**: Firebase ì—°ë™ ìƒíƒœ ì‹¤ì‹œê°„ í™•ì¸
- âœ… **ìë™ ë°±ì—…**: Firebase ì €ì¥ ì‹œ ë¡œì»¬ íŒŒì¼ë„ ìë™ ë°±ì—…

## ë°°í¬ ë° ì„œë²„ ê´€ë¦¬

### Oracle Cloud ë°°í¬ ìƒíƒœ

**í˜„ì¬ ìƒí™©** (2025ë…„ ê¸°ì¤€):
- âœ… **ì„œë²„ êµ¬ì¶• ì™„ë£Œ**: Oracle Cloud Infrastructureì— Ubuntu 22.04 ì„œë²„ êµ¬ì¶•
- âœ… **ë„ë©”ì¸ ì—°ê²° ì™„ë£Œ**: `ssurpass.com` ë„ë©”ì¸ ì—°ê²°
- âœ… **nginx ì„¤ì • ì™„ë£Œ**: ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ ì„¤ì •
- âš ï¸ **502 Bad Gateway ì˜¤ë¥˜**: Node.js ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ìƒíƒœ ì ê²€ ì¤‘
- ğŸ”§ **ë””ë²„ê¹… ì§„í–‰ ì¤‘**: `debug-server.sh` ìŠ¤í¬ë¦½íŠ¸ë¡œ ë¬¸ì œ ì§„ë‹¨

### ìë™ ë°°í¬ ì‹œìŠ¤í…œ

```bash
# GitHubì—ì„œ ìë™ ë°°í¬ íŠ¸ë¦¬ê±°
curl -X POST http://ssurpass.com/deploy -H "x-deploy-token: breadbro"
```

### Chrome ì„¤ì¹˜ ë¬¸ì œ í•´ê²°

### Oracle Cloud í™˜ê²½ì—ì„œì˜ Chrome ê´€ë ¨ ì˜¤ë¥˜

ì´ í”„ë¡œì íŠ¸ëŠ” Oracle Cloudì˜ í™˜ê²½ ì œì•½ì„ ê³ ë ¤í•˜ì—¬ Chrome ì„¤ì¹˜ë¥¼ ìë™í™”í•©ë‹ˆë‹¤:

1. **ìë™ ì„¤ì¹˜**: `npm install` ì‹œ Chromeì´ ìë™ìœ¼ë¡œ ì„¤ì¹˜ë©ë‹ˆë‹¤
2. **ë™ì  ê²½ë¡œ ì°¾ê¸°**: ì—¬ëŸ¬ ìœ„ì¹˜ì—ì„œ Chromeì„ ì°¾ì•„ ì‚¬ìš©í•©ë‹ˆë‹¤
3. **ì„¤ì • íŒŒì¼**: Chrome ê²½ë¡œë¥¼ `chrome-config.json`ì— ì €ì¥í•©ë‹ˆë‹¤

### ìˆ˜ë™ Chrome ì„¤ì¹˜ (í•„ìš” ì‹œ)

```bash
# Chrome ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
node scripts/install-chrome.js
```

### Chrome ê²½ë¡œ í™•ì¸

```bash
# ì„¤ì¹˜ëœ Chrome ìœ„ì¹˜ í™•ì¸
find . -name "chrome" -type f -executable
```

## í™˜ê²½ ë³€ìˆ˜

- `PORT`: ì„œë²„ í¬íŠ¸ (ê¸°ë³¸ê°’: 3000)
- `PUPPETEER_CACHE_DIR`: Chrome ì„¤ì¹˜ ë””ë ‰í† ë¦¬ (ì„ íƒì‚¬í•­)

## ê°œë°œ ë° ë””ë²„ê¹…

### ë¡œê·¸ í™•ì¸
- ì›¹ ì¸í„°í˜ì´ìŠ¤ì—ì„œ ì‹¤ì‹œê°„ ë¡œê·¸ í™•ì¸
- ì„œë²„ ì½˜ì†”ì—ì„œ ìƒì„¸ ë¡œê·¸ í™•ì¸

### Chrome ì„¤ì¹˜ ìƒíƒœ í™•ì¸
```bash
# Chrome ì„¤ì • íŒŒì¼ í™•ì¸
cat chrome-config.json

# Chrome ì‹¤í–‰ í…ŒìŠ¤íŠ¸
node -e "const puppeteer = require('puppeteer'); puppeteer.launch().then(b => { console.log('Chrome OK'); b.close(); })"
```

## ë¬¸ì œ í•´ê²°

### ì„œë²„ ë°°í¬ ê´€ë ¨ ë¬¸ì œë“¤

1. **502 Bad Gateway ì˜¤ë¥˜** (í˜„ì¬ í•´ê²° ì¤‘):
   ```bash
   # ì„œë²„ ìƒíƒœ ì§„ë‹¨
   ./debug-server.sh
   
   # PM2 í”„ë¡œì„¸ìŠ¤ ì¬ì‹œì‘
   pm2 restart all
   
   # Node.js ì• í”Œë¦¬ì¼€ì´ì…˜ ìˆ˜ë™ ì‹¤í–‰ í…ŒìŠ¤íŠ¸
   cd /home/ubuntu/joinkfacrawler
   node server.js
   ```

2. **ìë™ ë°°í¬ ì‹¤íŒ¨**:
   ```bash
   # ìˆ˜ë™ ë°°í¬
   cd /home/ubuntu/joinkfacrawler
   git pull
   npm install
   pm2 restart all
   ```

3. **nginx ê´€ë ¨ ë¬¸ì œ**:
   ```bash
   # nginx ìƒíƒœ í™•ì¸
   sudo systemctl status nginx
   
   # nginx ì„¤ì • í…ŒìŠ¤íŠ¸
   sudo nginx -t
   
   # nginx ì¬ì‹œì‘
   sudo systemctl restart nginx
   ```

### ì¼ë°˜ì ì¸ ë¬¸ì œë“¤

1. **Chrome not found ì˜¤ë¥˜**:
   - `npm install` ì¬ì‹¤í–‰
   - `node scripts/install-chrome.js` ìˆ˜ë™ ì‹¤í–‰

2. **Permission denied ì˜¤ë¥˜**:
   - `chmod +x render-build.sh` ì‹¤í–‰
   - íŒŒì¼ ê¶Œí•œ í™•ì¸

3. **Firebase ì—°ê²° ì˜¤ë¥˜**:
   - `firebase-adminsdk.json` íŒŒì¼ í™•ì¸
   - Firebase í”„ë¡œì íŠ¸ ì„¤ì • í™•ì¸

4. **CSV í¸ì§‘ì´ ë°˜ì˜ë˜ì§€ ì•ŠëŠ” ê²½ìš°**:
   - ì´ì œ Firebase ì—°ë™ìœ¼ë¡œ í•´ê²°ë¨!
   - ì›¹ì—ì„œ ì§ì ‘ í¸ì§‘í•˜ê³  "Firebaseì— ì €ì¥" í´ë¦­
   - ğŸ”„ ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ìœ¼ë¡œ ìµœì‹  ë°ì´í„° í™•ì¸

### Firebase CSV ê´€ë¦¬ ëª…ë ¹ì–´

```bash
# ë¡œì»¬ CSVë¥¼ Firebaseì— ë™ê¸°í™”
node firebase_uploader.js sync-csv

# Firebaseì—ì„œ CSV ë‹¤ìš´ë¡œë“œ
node firebase_uploader.js download-csv

# CSV ë‚´ìš©ì„ Firebaseì— ì—…ë¡œë“œ
node firebase_uploader.js upload-csv "CSVë‚´ìš©"
```

## í”„ë¡œì íŠ¸ í˜„í™© ë° ë¡œë“œë§µ

### ì™„ë£Œëœ ì‘ì—… âœ…
- KFA ë°ì´í„° í¬ë¡¤ë§ ì‹œìŠ¤í…œ êµ¬ì¶•
- Firebase ì—°ë™ ë° ì‹¤ì‹œê°„ ì—…ë¡œë“œ
- ì›¹ ì¸í„°í˜ì´ìŠ¤ ê°œë°œ (ë‹¤ì¤‘ í•„í„°ë§ ì§€ì›)
- Oracle Cloud Infrastructure ì„œë²„ êµ¬ì¶•
- ë„ë©”ì¸ ì—°ê²° ë° nginx ì„¤ì •
- ìë™ ë°°í¬ ì‹œìŠ¤í…œ êµ¬ì¶•
- Chrome ìë™ ì„¤ì¹˜ ì‹œìŠ¤í…œ

### ì§„í–‰ ì¤‘ì¸ ì‘ì—… ğŸ”§
- **502 Bad Gateway ì˜¤ë¥˜ í•´ê²°**: Node.js ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ìƒíƒœ ì ê²€
- ì„œë²„ ì•ˆì •ì„± ìµœì í™”
- ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ êµ¬ì¶•

### í–¥í›„ ê³„íš ğŸ“‹
- SSL ì¸ì¦ì„œ ì„¤ì • (HTTPS ì§€ì›)
- ë¡œê·¸ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ
- ì„±ëŠ¥ ìµœì í™” (ìºì‹±, CDN)
- ë°±ì—… ë° ë³µêµ¬ ì‹œìŠ¤í…œ

## ê¸°ìˆ  ì§€ì›

- **GitHub Repository**: [joinkfacrawler](https://github.com/essaisko/joinkfacrawler)
- **ì„œë²„ ë„ë©”ì¸**: `ssurpass.com`
- **ì´ìŠˆ ë¦¬í¬íŠ¸**: GitHub Issues í™œìš©

## ë¼ì´ì„ ìŠ¤

MIT License 